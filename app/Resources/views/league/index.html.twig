{% extends 'base.html.twig' %}

{% block content %}
    <div class="container">
        <div class="row" style="margin: 20px 0;">
            <h1 style="text-align: center">List of matches</h1>
            <a href="/logout">Log out</a>
            <div class="row" style="margin: 20px 0;">
                <table id="dataTable" class="display">
                    <tfoot>
                        <tr>
                            <th>Date</th>
                            <th>Home Team</th>
                            <th>Result</th>
                            <th>Result2</th>
                            <th>Guest Team</th>
                            <th></th>
                            <th></th>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    <script>
        $(document).ready(function(){
            $('#dataTable tfoot th').not(":eq(5),:eq(6)").each( function () {
                var title = $(this).text();
                $(this).html( '<input type="text" class="form-control" placeholder="Search '+title+'" />' );
            } );
            var table = $('#dataTable').DataTable({
                data: {{ matches | json_encode(constant('JSON_PRETTY_PRINT')) | raw }},
                columns: [
                    { title: "Date",  data: 'date' },
                    { title: "Home Team", data: 'homeTeam' },
                    { title: "Result", data: 'scored1' },
                    { title: "Result2", data: 'scored2', visible: false },
                    { title: "Guest Team", data: 'guestTeam' },
                    { title: "Edit", data: 'id',
                        "render": function(data,type,row,meta) {
                            var a = "<a target='_blank' href='/edit/"+row.id+"'><i class='fa fa-edit'></i>Edit</a>";
                            return a;
                        }
                    },
                    { title: "Delete", data: 'id',
                        "render": function(data,type,row,meta) {
                            var a = "<a target='_blank' href='/delete/"+row.id+"'><i class='fa fa-edit'></i>Delete</a>";
                            return a;
                        }
                    }
                ],
                pageLength: 10,
                lengthMenu: [ 5, 10, 50 ]
            });

            //var result = table.column( 2 ).data()[0].concat(' : ').concat(table.column( 3 ).data()[0]);
            //table.cell(0, 2).data(result);

            var len = {{ matches | length }}
            for (var index = 0; index < len; index++ ) {
               if ((table.column(2).data()[index] == null) || (table.column(3).data()[index] == null)) {
                   result = '? : ?';
                   table.cell(index, 2).data(result);
               }
               else {
                   var result = table.column(2).data()[index].concat(' : ').concat(table.column(3).data()[index]);
                   table.cell(index, 2).data(result);
               }
            }


            table.columns().every( function () {
                var that = this;
                $( 'input', this.footer() ).on( 'keyup change', function () {
                    if ( that.search() !== this.value ) {
                        that.search( this.value ).draw();
                    }
                } );
            } );
        });
    </script>
{% endblock %}

{% block stylesheets %}
    <style>
        td, th {
            text-align: center!important;
        }
    </style>
{% endblock %}